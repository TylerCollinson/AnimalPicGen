<!DOCTYPE html>
<html>
<head>
  <title>Cat Image Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
    }
    .container {
      max-width: 800px;
      margin: auto;
      padding: 20px;
    }
    h1 {
      font-size: 2.5em;
      color: #333;
    }
    .cat-container {
      margin-top: 20px;
      display: block; /* default stacked on mobile */
    }
    .cat-image {
      border: 5px solid #ccc;
      border-radius: 10px;
      margin: 10px auto;
      max-width: 100%;
      opacity: 0;
      transform: scale(0.95);
      transition: opacity 0.5s ease, transform 0.5s ease, filter 0.3s ease;
      display: block;
      will-change: opacity, transform, filter;
      cursor: pointer;
    }
    .cat-image.visible {
      opacity: 1;
      transform: scale(1);
    }
    .cat-image:hover {
      transform: scale(1.05);
      filter: brightness(1.1);
      transition: transform 0.3s ease, filter 0.3s ease;
      z-index: 5;
      position: relative;
    }
    .button {
      padding: 10px 20px;
      font-size: 1em;
      margin-top: 20px;
      cursor: pointer;
      border: none;
      background-color: #28a745;
      color: white;
      border-radius: 5px;
    }
    .button:hover {
      background-color: #218838;
    }
    @media screen and (min-width: 1024px) {
      .cat-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        grid-gap: 15px;
        justify-items: center;
      }
      .cat-image {
        margin: 0;
        max-width: 100%;
        width: 100%;
      }
    }

    /* Modal styles */
    .modal-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease;
    }
    .modal-overlay.visible {
      opacity: 1;
      visibility: visible;
    }
    .modal-content {
      position: relative;
      max-width: 90%;
      max-height: 90%;
    }
    .modal-content img {
      width: 100%;
      height: auto;
      border-radius: 10px;
    }
    .modal-close-btn {
      position: absolute;
      top: -15px;
      right: -15px;
      background: white;
      border-radius: 50%;
      border: none;
      font-size: 24px;
      font-weight: bold;
      width: 40px;
      height: 40px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      line-height: 38px;
      text-align: center;
      padding: 0;
    }

    @keyframes confetti-fall {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: #f2d74e;
      opacity: 0;
      animation: confetti-fall 2s forwards;
      pointer-events: none;
      z-index: 9999;
    }

  </style>
</head>
<body>
  <div class="container">
    <h1>Cat Image Generator ðŸ˜Š</h1>
    <p>Hold enter for a large dose of pics</p>
    <div class="cat-container" id="catContainer"></div>
    <button class="button" id="fetchButton">Fetch More Cats</button>
  </div>

  <!-- Modal overlay -->
  <div id="modalOverlay" class="modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-content">
      <button id="modalClose" class="modal-close-btn" aria-label="Close modal">&times;</button>
      <img id="modalImage" src="" alt="Expanded cat image">
    </div>
  </div>

  

  <script>
    const localCatImages = [
      'cat/cat/HolderleCats/cat1.jpg',
      'cat/HolderleCats/cat2.jpg',
      'cat/HolderleCats/cat3.jpg',
      'cat/HolderleCats/cat4.jpg',
      'cat/HolderleCats/cat5.jpg',
      'cat/HolderleCats/cat6.jpg',
      'cat/HolderleCats/cat7.jpg',
      'cat/HolderleCats/cat8.jpg',
      'cat/HolderleCats/cat9.jpg',
      'cat/HolderleCats/cat10.jpg',
      'cat/HolderleCats/cat11.jpg',
      'cat/HolderleCats/cat12.jpg',
      'cat/HolderleCats/cat13.jpg',
      'cat/HolderleCats/cat14.jpg',
      'cat/HolderleCats/cat15.jpg',
      'cat/HolderleCats/cat16.jpg',
      'cat/HolderleCats/cat17.jpg',
      'cat/HolderleCats/cat18.jpg',
      'cat/HolderleCats/cat19.jpg',
      'cat/HolderleCats/cat20.jpg',
      'cat/HolderleCats/cat21.jpg',
      'cat/HolderleCats/cat22.jpg',
      'cat/HolderleCats/cat23.jpg',
      'cat/HolderleCats/cat24.jpg',
      'cat/HolderleCats/cat25.jpg',
      'cat/HolderleCats/cat26.jpg',
      'cat/HolderleCats/cat27.jpg',
      'cat/HolderleCats/cat28.jpg',
      'cat/HolderleCats/cat29.jpg',
      'cat/HolderleCats/cat30.jpg',
      'cat/HolderleCats/cat31.jpg',
      'cat/HolderleCats/cat32.jpg',
      'cat/HolderleCats/cat33.jpg',
      'cat/HolderleCats/cat34.jpg',
      'cat/HolderleCats/cat35.jpg',
      'cat/HolderleCats/cat36.jpg',
      'cat/HolderleCats/cat37.jpg',
      'cat/HolderleCats/cat38.jpg',
      'cat/HolderleCats/cat39.jpg',
      'cat/HolderleCats/cat40.jpg',
      'cat/HolderleCats/cat41.jpg',
      'cat/HolderleCats/cat42.jpg',
      'cat/HolderleCats/cat43.jpg'
    ];



    const catContainer = document.getElementById('catContainer');
    const modalOverlay = document.getElementById('modalOverlay');
    const modalImage = document.getElementById('modalImage');
    const modalClose = document.getElementById('modalClose');

    function fetchCatImage() {
      if (Math.random() < 0.20) {  // 20% chance to use local images
        const randomIndex = Math.floor(Math.random() * localCatImages.length);
        const imageUrl = localCatImages[randomIndex];
        const imgElement = document.createElement('img');
        imgElement.src = imageUrl;
        imgElement.alt = 'A cute kitty';
        imgElement.className = 'cat-image holderle-cat';

        // Click handler for modal
        imgElement.addEventListener('click', () => {
          openModal(imageUrl);
        });

        catContainer.appendChild(imgElement);
        observer.observe(imgElement); // fade in on scroll

      } else {
        // 80% chance fetch from cat API
        fetch('https://api.thecatapi.com/v1/images/search')
        .then(response => response.json())
        .then(data => {
          const imageUrl = data[0].url;
          const imgElement = document.createElement('img');
          imgElement.src = imageUrl;
          imgElement.alt = 'A cute kitty';
          imgElement.className = 'cat-image';

          // Click handler for modal
          imgElement.addEventListener('click', () => {
            openModal(imageUrl);
          });

          catContainer.appendChild(imgElement);
          observer.observe(imgElement); // fade in on scroll
        })
        .catch(error => console.log('Error occurred: ' + error));
      }
    }


    // Intersection Observer for images
const observer = new IntersectionObserver((entries, obs) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');

      // Only show confetti for Holderle local images
      if (entry.target.classList.contains('holderle-cat')) {
        const rect = entry.target.getBoundingClientRect();

        // Create a container positioned over the image
        const confettiContainer = document.createElement('div');
        confettiContainer.style.position = 'absolute';
        confettiContainer.style.left = rect.left + window.scrollX + 'px';
        confettiContainer.style.top = rect.top + window.scrollY + 'px';
        confettiContainer.style.width = rect.width + 'px';
        confettiContainer.style.height = rect.height + 'px';
        confettiContainer.style.pointerEvents = 'none';
        confettiContainer.style.overflow = 'visible';
        confettiContainer.style.zIndex = '9999';
        document.body.appendChild(confettiContainer);

        // Generate and animate confetti pieces
        for (let i = 0; i < 25; i++) {
          const confetti = document.createElement('div');
          confetti.className = 'confetti';

          // Random color and position
          const colors = ['#f2d74e', '#95c3de', '#ff9a9e', '#a1ffce', '#fbc2eb'];
          confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
          confetti.style.left = (Math.random() * rect.width) + 'px';
          confetti.style.top = (Math.random() * rect.height * 0.3) + 'px';
          confetti.style.opacity = 1;
          confetti.style.animation = 'confetti-fall 2.5s ease-in forwards';
          confetti.style.animationDelay = (Math.random() * 0.5) + 's';
          confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
          confettiContainer.appendChild(confetti);

          // Auto-remove after animation
          confetti.addEventListener('animationend', () => {
            confetti.remove();
            if (confettiContainer.childElementCount === 0) {
              confettiContainer.remove();
            }
          });
        }
      }

      // Stop observing this image so the effect doesnâ€™t repeat
      obs.unobserve(entry.target);
    }
  });
});




    document.getElementById('fetchButton').addEventListener('click', fetchCatImage);
    fetchCatImage(); // initial fetch

    // Show modal with image
    function openModal(src) {
      modalImage.src = src;
      modalOverlay.classList.add('visible');
      modalOverlay.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden'; // prevent background scroll
    }

    // Close modal function
    function closeModal() {
      modalOverlay.classList.remove('visible');
      modalOverlay.setAttribute('aria-hidden', 'true');
      modalImage.src = '';
      document.body.style.overflow = ''; // restore scroll
    }

    // Close modal on close button click
    modalClose.addEventListener('click', closeModal);

    // Close modal on clicking outside the image content
    modalOverlay.addEventListener('click', (e) => {
      if (e.target === modalOverlay) {
        closeModal();
      }
    });

    // Close modal on pressing Escape key
    document.addEventListener('keydown', (e) => {
      if(e.key === 'Escape' && modalOverlay.classList.contains('visible')) {
        closeModal();
      }
    });
  </script>
</body>
</html>
